<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eleven Builder</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 496.2 496.2' xml:space='preserve'%3E%3Cpath style='fill:%2365A844;' d='M0,248.1C0,111.1,111.1,0,248.1,0s248.1,111.1,248.1,248.1S385.1,496.2,248.1,496.2S0,385.1,0,248.1z'/%3E%3Cg%3E%3Cpath style='fill:%23C9E5A1;' d='M250.1,210.1V0c-0.7,0-1.3,0-2,0c-0.7,0-1.3,0-2,0v210c-20.1,1-36.1,17.7-36.1,38s16,37,36.1,38v210 c0.7,0,1.3,0,2,0c0.7,0,1.3,0,2,0V286.1c20.1-1,36.1-17.7,36.1-38S270.2,211.1,250.1,210.1z M214,248.1c0-18.1,14.2-33,32.1-34v31 c-0.9,0.6-1.6,1.7-1.6,3c0,1.3,0.6,2.3,1.6,3v31C228.2,281.1,214,266.2,214,248.1z M250.1,282.1v-31c0.9-0.6,1.6-1.7,1.6-3 s-0.6-2.3-1.6-3v-31c17.9,1,32.1,15.9,32.1,34S268,281.1,250.1,282.1z'/%3E%3Ccircle style='fill:%23C9E5A1;' cx='449.6' cy='248.1' r='3.6'/%3E%3Ccircle style='fill:%23C9E5A1;' cx='46.6' cy='248.1' r='3.6'/%3E%3Cpath style='fill:%23C9E5A1;' d='M433.3,282.8v-69.4v-46.1h49.4c-0.5-1.3-0.9-2.7-1.4-4h-52v52.5c-11,6.9-17.8,19.2-17.8,32.3 c0,13.2,6.8,25.5,17.8,32.4v53.3h51.6c0.5-1.3,1-2.7,1.4-4h-49.1v-47H433.3z M415.5,248.1c0-10.9,5.2-21.1,13.8-27.5v55 C420.6,269.3,415.5,259.3,415.5,248.1z'/%3E%3Cpath style='fill:%23C9E5A1;' d='M472,212.3h21.5c-0.2-1.3-0.4-2.7-0.6-4H468v80.5h24.8c0.2-1.3,0.4-2.7,0.6-4H472V212.3z'/%3E%3Cpath style='fill:%23C9E5A1;' d='M67.4,216.6v-53.3H14.9c-0.5,1.3-0.9,2.7-1.4,4h49.9v47v69.4v46.1H13.8c0.5,1.3,0.9,2.7,1.4,4h52.2 v-52.5c11-6.9,17.8-19.2,17.8-32.3C85.2,235.7,78.4,223.5,67.4,216.6z M67.4,276.4v-55c8.7,6.3,13.8,16.4,13.8,27.6 C81.2,259.9,76,270.1,67.4,276.4z'/%3E%3Cpath style='fill:%23C9E5A1;' d='M28.7,208.3H3.2c-0.2,1.3-0.4,2.7-0.6,4h22.1v72.5h-22c0.2,1.3,0.4,2.7,0.6,4h25.4V208.3z'/%3E%3C/g%3E%3C/svg%3E">

    <style>
      .player-container {
        min-width: 60px;
        max-width: 140px; /* Increased max size for desktop */
        width: 12vw; /* Larger viewport percentage */
        margin: 5px;
        flex: 1 1 auto;
        transition: all 0.3s ease; /* Smooth resizing */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center; /* Ensures proper vertical alignment */
    }
    
    .player-container svg {
        width: 100%;
        height: auto;
        max-height: 120px; /* Limit maximum height */
    }
    
    .player-container input {
        width: 100%;
        height: 40px; /* Ensures all inputs are the same height */
        font-size: medium;
        font-weight: bold;
        text-align: center; /* Centers text inside input */
        padding: 5px 0; /* Adjust padding to avoid shifting text */
        box-sizing: border-box; /* Ensures padding doesn't affect width */
        border: 2px solid black;
    }
    
    /* Fixes input size inconsistency inside a row */
    .formation-row {
        display: flex;
        justify-content: space-between; /* Better space distribution */
        flex-wrap: nowrap;
        gap: 10px;
        width: 100%;
        min-height: 120px; /* Taller rows for desktop */
    }
    
    /* Ensures all inputs in a row have the same height */
    .formation-row .player-container input {
        flex-grow: 1;
    }
    
    #lineup {
        display: flex;
        flex-direction: column;
        gap: 20px;
        width: 100%;
        padding: 20px;
        box-sizing: border-box;
        max-width: 1600px; /* Increased max width */
        margin: 0 auto;
        overflow: hidden;
    }
    
    .controls {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      padding: 20px;
      justify-content: center;
      align-items: center; /* Ensures everything is vertically aligned */
      max-width: 1200px;
      margin: 0 auto;
  }
  
  /* Wrap label and input in a flex container for better alignment */
  .controls .color-picker-container {
      display: flex;
      align-items: center;
      gap: 8px; /* Space between label and color input */
  }
  
  /* Style for labels */
  .controls label {
      font-size: 16px;
      font-weight: bold;
      color: #333;
  }
  
  /* Style for color inputs */
  .controls input[type="color"] {
      width: 40px;
      height: 40px;
      border: none;
      padding: 5px;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.2s ease;
  }
  
  .controls input[type="color"]:hover {
      transform: scale(1.1);
  }
  
  /* Style for select dropdown */
  .controls select {
      font-size: 16px;
      padding: 8px 12px;
      border: 2px solid #333;
      border-radius: 5px;
      background-color: #fff;
      cursor: pointer;
      transition: all 0.2s ease;
  }
  
  .controls select:hover {
      border-color: #666;
  }
  
  /* Style for buttons */
  .controls button {
      font-size: 16px;
      font-weight: bold;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      background-color: #007BFF;
      color: white;
      cursor: pointer;
      transition: background 0.2s ease, transform 0.2s ease;
  }
  
  .controls button:hover {
      background-color: #0056b3;
      transform: scale(1.05);
  }
  
    
    /* Desktop optimization */
    @media (min-width: 1024px) {
        .player-container {
            min-width: 80px;
            max-width: 160px;
            width: 14vw;
            margin: 10px;
        }
        
        .formation-row {
            min-height: 150px;
            gap: 20px;
        }
    
        #lineup {
            padding: 40px;
        }
    }
    
    /* Mobile optimization */
    @media (max-width: 600px) {
        .player-container {
            min-width: 40px;
            width: 18vw;
        }
        
        .formation-row {
            min-height: 80px;
        }
    }
    
      </style>
    <script>
   
      document.addEventListener("DOMContentLoaded", (event) => {
        let select = document.getElementById("formation");
        let formations = {
          "4 Defenders": [
            "4-3-3",
            "4-4-2",
            "4-2-3-1",
            "4-1-4-1",
            "4-3-2-1",
            "4-5-1",
            "4-2-2-2",
            "4-4-1-1",
            "4-2-1-3",
            "4-1-2-1-2",
            "4-1-3-2",
            "4-3-1-2",
            "4-2-1-2",
          ],
          "5 Defenders": [
            "5-3-2",
            "5-4-1",
            "5-2-3",
            "5-2-2-1",
            "5-3-1-1",
            "5-2-1-2",
          ],
          "3 Defenders": [
            "3-4-3",
            "3-5-2",
            "3-4-1-2",
            "3-4-2-1",
            "3-6-1",
            "3-5-1-1",
          ],
          "2 Defenders": ["2-3-5", "2-4-4", "2-5-3", "2-3-2-3", "2-4-3-1"],
          "1 Defender": ["1-4-5", "1-3-6", "1-2-7", "1-4-3-2"],
          "Funny Formations": [
            "10-0-0",
            "0-10-0",
            "0-0-10",
            "1-1-8",
            "6-6-6",
            "9-0-1",
            "2-2-6",
            "7-2-1",
            "1-8-1",
            "0-5-5",
            "4-2-4",
            "3-2-5",
            "2-3-5",
            "1-6-3",
            "8-1-1",
          ],
        };

        for (let groupName in formations) {
          if (formations.hasOwnProperty(groupName)) {
            let optgroup = document.createElement("optgroup");
            optgroup.label = groupName;

            for (let formation of formations[groupName]) {
              let option = document.createElement("option");
              option.value = formation;
              option.innerText = formation;
              optgroup.appendChild(option);
            }

            select.appendChild(optgroup);
          }
        }
        select.selectedIndex = 0;
        select.dispatchEvent(new Event("change"));
      });

      function rearrangeFormation(event) {
        let formation = event.srcElement.selectedOptions[0].value;
        formation = formation.split("-");
        formation = formation.map((val) => {
          return parseInt(val);
        });
        formation.unshift(1);

        const svg = `<svg viewBox="0 -7.72 127.24603 127.24603" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 856 412" xml:space="preserve" version="1.1" y="0px" x="0px" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/">
            <g>
            <path class="secondary" fill="${document.getElementById("secondary").value}" d="m32 109c-1.4 0-2.5-1.1-2.5-2.5v-62.6l-7 5.9c-.1.1-.2.1-.2.2-1 .6-2.1 1-3.2 1-2 0-3.8-1-4.9-2.6l-10.7-16.1c-1.8-2.7-1-6.3 1.7-8.1l29.7-20.7c.2-.1.4-.3.7-.3.1 0 2.8-.9 6.6-1h3.1c.7 0 1.4.3 1.8.8.5.5.7 1.2.6 1.9 0 .1 0 .3-.1.4.2 7.5 8.1 14.5 16.5 14.5s16.3-7 16.5-14.5c0-.1 0-.3-.1-.4-.1-.7.2-1.4.6-1.9s1.1-.8 1.8-.8h6.1c2.4 0 4.3 1.1 4.5 1.2.1 0 .1.1.2.1l28.7 20.7c2.6 1.7 3.4 5.4 1.6 8.1l-10.7 15.2c-1 1.6-2.9 2.6-4.9 2.6-1.2 0-2.3-.3-3.2-1-.1 0-.1-.1-0.2-.2l-6.4-5.3-.2 62.9c0 1.4-1.1 2.5-2.5 2.5h-63.9z"/>
            <path class="primary" fill="${document.getElementById("primary").value}" d="m42.2 2.5c-3.8.1-6.5 1-6.6 1-.3 0-.5.20-.7.30l-3 2.09v51h-2.4v50.1c0 1 1.1 2 2.5 2h63.9c1.4 0 2.5-1 2.5-2l.1-50.2h-2.6v-51.4l-2.2-1.6c-.1 0-.1-.10-.2-.10-.2-.10-2.1-1.2-4.5-1.2h-6.1c-.7 0-1.4.30-1.8.80s-.7 1.2-.6 1.9c.1.10.1.30.1.40-.2 7.5-8.1 14.5-16.5 14.5s-16.3-7-16.5-14.5c.1-.10.1-.30.1-.40.1-.70-.1-1.4-.6-1.9-.4-.50-1.1-.80-1.8-.80h-3.1z"/>
            <path d="m89.1 5c1.8 0 3.1.9 3.1.9l28.7 20.6c1.6 1 2 3.1.9 4.7l-10.7 15.1c-0.6 1-1.7 1.5-2.8 1.5-.6 0-1.3-.2-1.9-.6l-10.5-8.6-.2 68.2h-63.7v-68l-11.2 9.4c-.6.4-1.2.6-1.9.6-1.1 0-2.2-.5-2.8-1.5l-10.6-16.1c-1-1.6-.6-3.6.9-4.7l29.7-20.7s2.4-.8 5.8-.9h3.1v.2.2c0 9 9.1 17.3 19 17.3s19-8.3 19-17.3v-.2-.2h5.9.2c-.1.1 0 .1 0 .1m0-5s-.1 0 0 0h-.2-5.9c-1.4 0-2.7.6-3.7 1.6-.9 1-1.4 2.4-1.3 3.8v.4c-.3 6.1-7.1 11.9-14 11.9s-13.7-5.8-14-11.9v-.4c.1-1.4-.3-2.8-1.3-3.8-.9-1-2.3-1.6-3.7-1.6h-3.1-.1c-4 .1-6.9 1-7.3 1.1-.5.2-.9.4-1.3.7l-29.5 20.6c-3.8 2.6-4.8 7.7-2.3 11.6l10.7 16.1c1.6 2.3 4.2 3.7 7 3.7 1.6 0 3.2-.5 4.6-1.4.2-.1.3-.2.5-.3l2.9-2.5v57.2c0 2.8 2.2 5 5 5h63.8c2.8 0 5-2.2 5-5l.1-57.7 2.3 1.9c.1.1.3.2.4.3 1.4.9 3 1.4 4.6 1.4 2.8 0 5.4-1.4 6.9-3.7l10.6-15 .1-.1c2.5-3.8 1.5-9-2.3-11.5l-28-20.9c-.1-.1-.2-.1-.3-.2-.3-.2-2.6-1.5-5.6-1.5z"/>
            </g>
            </svg>`;

        const keeper = `<svg viewBox="0 -7.72 127.24603 127.24603" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 856 412" xml:space="preserve" version="1.1" y="0px" x="0px" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/">
                <g>
                    <path class="primary" fill="${document.getElementById("primary").value}" d="m32 109c-1.4 0-2.5-1.1-2.5-2.5v-62.6l-7 5.9c-.1.1-.2.1-.2.2-1 .6-2.1 1-3.2 1-2 0-3.8-1-4.9-2.6l-10.7-16.1c-1.8-2.7-1-6.3 1.7-8.1l29.7-20.7c.2-.1.4-.3.7-.3.1 0 2.8-.9 6.6-1h3.1c.7 0 1.4.3 1.8.8.5.5.7 1.2.6 1.9 0 .1 0 .3-.1.4.2 7.5 8.1 14.5 16.5 14.5s16.3-7 16.5-14.5c0-.1 0-.3-.1-.4-.1-.7.2-1.4.6-1.9s1.1-.8 1.8-.8h6.1c2.4 0 4.3 1.1 4.5 1.2.1 0 .1.1.2.1l28.7 20.7c2.6 1.7 3.4 5.4 1.6 8.1l-10.7 15.2c-1 1.6-2.9 2.6-4.9 2.6-1.2 0-2.3-.3-3.2-1-.1 0-.1-.1-0.2-.2l-6.4-5.3-.2 62.9c0 1.4-1.1 2.5-2.5 2.5h-63.9z"/>
                    <path class="secondary" fill="${document.getElementById("secondary").value}" d="m42.2 2.5c-3.8.1-6.5 1-6.6 1-.3 0-.5.20-.7.30l-3 2.09v51h-2.4v50.1c0 1 1.1 2 2.5 2h63.9c1.4 0 2.5-1 2.5-2l.1-50.2h-2.6v-51.4l-2.2-1.6c-.1 0-.1-.10-.2-.10-.2-.10-2.1-1.2-4.5-1.2h-6.1c-.7 0-1.4.30-1.8.80s-.7 1.2-.6 1.9c.1.10.1.30.1.40-.2 7.5-8.1 14.5-16.5 14.5s-16.3-7-16.5-14.5c.1-.10.1-.30.1-.40.1-.70-.1-1.4-.6-1.9-.4-.50-1.1-.80-1.8-.80h-3.1z"/>
                    <path d="m89.1 5c1.8 0 3.1.9 3.1.9l28.7 20.6c1.6 1 2 3.1.9 4.7l-10.7 15.1c-0.6 1-1.7 1.5-2.8 1.5-.6 0-1.3-.2-1.9-.6l-10.5-8.6-.2 68.2h-63.7v-68l-11.2 9.4c-.6.4-1.2.6-1.9.6-1.1 0-2.2-.5-2.8-1.5l-10.6-16.1c-1-1.6-.6-3.6.9-4.7l29.7-20.7s2.4-.8 5.8-.9h3.1v.2.2c0 9 9.1 17.3 19 17.3s19-8.3 19-17.3v-.2-.2h5.9.2c-.1.1 0 .1 0 .1m0-5s-.1 0 0 0h-.2-5.9c-1.4 0-2.7.6-3.7 1.6-.9 1-1.4 2.4-1.3 3.8v.4c-.3 6.1-7.1 11.9-14 11.9s-13.7-5.8-14-11.9v-.4c.1-1.4-.3-2.8-1.3-3.8-.9-1-2.3-1.6-3.7-1.6h-3.1-.1c-4 .1-6.9 1-7.3 1.1-.5.2-.9.4-1.3.7l-29.5 20.6c-3.8 2.6-4.8 7.7-2.3 11.6l10.7 16.1c1.6 2.3 4.2 3.7 7 3.7 1.6 0 3.2-.5 4.6-1.4.2-.1.3-.2.5-.3l2.9-2.5v57.2c0 2.8 2.2 5 5 5h63.8c2.8 0 5-2.2 5-5l.1-57.7 2.3 1.9c.1.1.3.2.4.3 1.4.9 3 1.4 4.6 1.4 2.8 0 5.4-1.4 6.9-3.7l10.6-15 .1-.1c2.5-3.8 1.5-9-2.3-11.5l-28-20.9c-.1-.1-.2-.1-.3-.2-.3-.2-2.6-1.5-5.6-1.5z"/>
                </g>
                <text x="50%" y="50%" fill="white" stroke="black" stroke-width="2" text-anchor="middle" dominant-baseline="middle" font-size="40px" font-family="Arial">GK</text>
            </svg>`;

        let main = document.getElementById("lineup");
        main.innerHTML = "";

        let rows = formation.length;
        for (let i = rows - 1; i >= 0; i--) {
          let row = document.createElement("div");
          row.id = i;
          row.style.display = "flex";
          row.style.flexDirection = "row";
          row.style.alignItems = "center";
          row.style.justifyContent = "center";
          row.style.width = "100%";
          row.style.minHeight = "100px";

          for (let j = formation[i]; j > 0; j--) {
            let player = document.createElement("input");
            player.name = "formation";
            player.className = 'player_name'
            player.id = i + " " + j;


            let icon = document.createElement("svg");
            icon.innerHTML = svg;
            if (i == 0) {
              icon.innerHTML = keeper;
            }

            let div = document.createElement("div");
            div.className = "player-container";
            div.style.display = "flex";
            div.style.flexDirection = "column";
            div.style.alignItems = "center";

            div.appendChild(icon);
            div.appendChild(player);

            row.appendChild(div);
          }

          main.appendChild(row);
        }
      }

      function changeShirtColor(event, type) {
        let svgs = document.getElementsByClassName(type);
        for (svg of svgs) {
          svg.setAttribute("fill", event.target.value);
        }
      }
      function reset() {
        document.querySelectorAll("input[name='formation']").forEach((input) => {
            input.value = ''; // Clear input
        });
    }

    async function share(event) {
      const button = event.target; // Get the button element
      const originalText = button.innerHTML; // Store the original text
  
      // Set button to loading state with a spinner
      button.innerHTML = `<span class="spinner"></span> Sharing...`;
      button.disabled = true; // Disable button to prevent multiple clicks
  
      const lineupSection = document.getElementById("lineup");
      if (!lineupSection) {
          alert("Lineup section not found.");
          button.innerHTML = originalText; // Restore button text
          button.disabled = false;
          return;
      }
  
      // Increase the quality by setting a higher scale factor
      const scaleFactor = 5;
  
      try {
          const canvas = await html2canvas(lineupSection, { scale: scaleFactor });
          const blob = await new Promise(resolve => canvas.toBlob(resolve, "image/png"));
  
          if (!blob) {
              alert("Could not convert canvas to blob.");
              button.innerHTML = originalText; // Restore button text
              button.disabled = false;
              return;
          }
  
          // Convert blob to a File object
          const file = new File([blob], "lineup_screenshot.png", { type: "image/png" });
  
          // Detect if the user is on mobile
          const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  
          if (isMobile && navigator.canShare && navigator.canShare({ files: [file] })) {
              // Share via Web Share API (for mobile)
              await navigator.share({
                  title: "Check out this lineup!",
                  text: "Sharing my lineup.",
                  files: [file]
              });
              console.log("Image shared successfully");
          } else {
              // Copy image to clipboard for desktop users
              try {
                  const clipboardItem = new ClipboardItem({ "image/png": blob });
                  await navigator.clipboard.write([clipboardItem]);
                  alert("High-quality screenshot copied to clipboard successfully!");
              } catch (err) {
                  alert("Failed to copy image to clipboard: " + err);
              }
          }
      } catch (err) {
          alert("Error capturing or sharing the screenshot: " + err);
      }
  
      // Restore button text and enable it again
      button.innerHTML = originalText;
      button.disabled = false;
  }
        


    </script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

</head>
  <body>
    <main>
      <div class="controls">
        <label for="primary">Primary Color</label>
        <input
          value="#FFFFFF"
          onchange="changeShirtColor(event, 'primary')"
          type="color"
          name="primary"
          id="primary"
        />

        <label for="secondary">Secondary Color</label>
        <input
          value="#C80FFF"
          onchange="changeShirtColor(event, 'secondary')"
          type="color"
          name="secondary"
          id="secondary"
        />
        <label for="formation"> Formation: </label>
        <select
          onchange="rearrangeFormation(event)"
          name="formation"
          id="formation"
        ></select>
        <button onclick="reset()">Reset</button>
        <button onclick="share(event)">Share lineup</button>
      </div>
      <section id="lineup"></section>
    </main>
  </body>
</html>